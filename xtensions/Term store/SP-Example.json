{
    "swagger": "2.0",
    "info": {
      "version": "1.0.0",
      "title": "SharePoint Term Store Lookup",
      "description": "Term store lookup"
    },
    "host": "graph.microsoft.com",
    "basePath": "/beta",
    "schemes": ["https"],
    "x-ntx-render-version": 2,
    "produces": ["application/json"],
    "paths": {
      "/termStore/groups": {
        "get": {
          "tags": [
            "Term Store",
            "Groups"
          ],
          "summary": "List all term groups",
          "x-ntx-summary": "List all term groups",
          "operationId": "ListTermGroups",
          "produces": [ "application/json" ],
          "parameters": [],
          "responses": {
            "200": {
              "description": "Term groups retrieved successfully",
              "schema": {
                "type": "object",
                "properties": {
                  "value": {
                    "type": "array",
                    "items": {
                      "$ref": "#/definitions/TermGroup"
                    }
                  }
                }
              }
            },
            "default": {
              "description": "Operation Failed"
            }
          },
          "security": [
            {
              "functions_auth": [
                "TermStore.Read",
                "TermStore.ReadWrite"
              ]
            }
          ]
        }
      },
      "/termStore/groups/{termGroupId}/sets": {
        "get": {
          "tags": [
            "Term Store",
            "Sets"
          ],
          "summary": "List all sets in a term group",
          "x-ntx-summary": "List all sets in a group",
          "operationId": "ListSets",
          "parameters": [
            {
              "name": "termGroupId",
              "in": "path",
              "required": true,
              "type": "string",
              "x-ntx-summary": "Select a term group",
              "x-ntx-dynamic-values": {
                "operationId": "ListTermGroups",
                "value-path": "Id",
                "value-title": "Display Name",
                "value-collection":"Value"
              }
            }
          ],
          "responses": {
            "200": {
              "description": "Sets retrieved successfully",
              "schema": {
                "type": "object",
                "properties": {
                  "value": {
                    "type": "array",
                    "items": {
                      "$ref": "#/definitions/Set"
                    }
                  }
                }
              }
            },
            "default": {
              "description": "Operation Failed"
            }
          },
          "security": [
            {
              "functions_auth": [
                "TermStore.Read",
                "TermStore.ReadWrite"
              ]
            }
          ]
        }
      },
      "/termStore/groups/{termGroupId}/sets/{setId}/terms": {
        "get": {
          "tags": [
            "Term Store",
            "Terms"
          ],
          "summary": "List all terms in a set",
          "x-ntx-summary": "List terms of a set",
          "operationId": "ListTerms",
          "parameters": [
            {
              "name": "termGroupId",
              "in": "path",
              "required": true,
              "type": "string",
              "x-ntx-dynamic-values": {
                "operationId": "ListTermGroups",
                "value-path": "Id",
                "value-title": "Display name",
                "value-collection":"Value"
              }
            },
            {
              "name": "setId",
              "in": "path",
              "required": true,
              "type": "string",
              "x-ntx-dynamic-values": {
                "operationId": "ListSets",
                "parameters": {
                  "termGroupId": {
                    "parameter": "termGroupId"
                  }
                },
                "value-path": "id",
                "value-title": "name",
                "value-collection":"value"
              }
            }
          ],
          "responses": {
            "200": {
              "description": "Terms retrieved successfully",
              "schema": {
                "type": "object",
                "properties": {
                  "value": {
                    "type": "array",
                    "items": {
                      "$ref": "#/definitions/Term"
                    }
                  }
                }
              }
            },
            "default": {
              "description": "Operation Failed"
            }
          },
          "security": [
            {
              "functions_auth": [
                "TermStore.Read",
                "TermStore.ReadWrite"
              ]
            }
          ]
        }
      }
    },
    "definitions": {
      "Term": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "id": {
            "type": "string",
            "description": "The unique identifier of the term"
          },
          "labels": {
            "type": "array",
            "items": {
              "$ref": "#/definitions/Label"
            }
          }
        }
      },
      "Label": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "name": {
            "type": "string",
            "description": "The name of the label"
          }
        }
      },
      "TermGroup": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "id": {
            "type": "string",
            "description": "The unique identifier of the term group"
          },
          "displayName": {
            "type": "string",
            "description": "The display name of the term group"
          }
        }
      },
      "Set": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
            "id": {
                "type": "string",
                "description": "The unique identifier of the term set"
            },
            "localizedNames": {
                "type": "array",
                "items": {
                    "$ref": "#/definitions/LocalizedName"
                }
            }
        }
    },
    "LocalizedName": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
            "name": {
                "type": "string",
                "description": "The localized name of the term set"
            }
        }
    }    
    },
    "securityDefinitions": {
      "functions_auth": {
        "type": "oauth2",
        "flow": "accessCode",
        "authorizationUrl": "https://login.microsoftonline.com/common/oauth2/authorize",
        "tokenUrl": "https://login.microsoftonline.com/common/oauth2/token",
        "scopes": {
          "TermStore.Read": "Read access to the term store",
          "TermStore.Write": "Write access to the term store",
          "TermStore.ReadWrite": "Read and write access to the term store"
        }
      }
    }
  }